TEST_FLAGS=-fcf-protection=full -fno-stack-protector -no-pie -w
CFBENDING_FLAGS=-fcf-protection=full -fno-stack-protector -no-pie -w


all: mkbin cfbending test
	@echo "All targets built!"

clean:
	rm -r ./bin

mkbin:
	@if [ ! -d ./bin ]; then mkdir bin && echo "Created directory ./bin"; fi
	
test: mkbin
	gcc ${TEST_FLAGS} -o ./bin/test_shstk ./tests/test_shstk.c
	gcc ${TEST_FLAGS} -o ./bin/test_exec_shstk ./tests/test_exec_shstk.c

cfbending: mkbin
	gcc ${CFBENDING_FLAGS} -o ./bin/exec_hijack ./cfbending/exec_hijack.c
	gcc ${CFBENDING_FLAGS} -o ./bin/exec_hijack_realistic ./cfbending/exec_hijack_realistic.c
