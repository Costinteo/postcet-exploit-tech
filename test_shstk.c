#include <stdio.h>
#include <string.h>
#include <asm/prctl.h>        /* Definition of ARCH_* constants */
#include <sys/syscall.h>      /* Definition of SYS_* constants */
#include <unistd.h>
#include <signal.h>

void win() {
	puts("You won!");
}

void redirect_to_win() {
	char *p;
	p = &p;
	*(unsigned long long *)(p + 16) = (unsigned long long)win;
}

int main(int argc, char *argv[]) {
	int status;
	int ret = syscall(SYS_arch_prctl, ARCH_SHSTK_STATUS, &status);
	printf("syscall_ret: %d shstk_status: %d\n", ret, status);
	redirect_to_win();
	return 0;
}

