#include <stdio.h>
#include <string.h>
#include <asm/prctl.h>        /* Definition of ARCH_* constants */
#include <sys/syscall.h>      /* Definition of SYS_* constants */
#include <unistd.h>
#include <signal.h>

void win() {
	while(1){};
	puts("You won!");
}

void vulnerable_function() {
	char buffer[8];
	scanf("%s", buffer);
}

int main(int argc, char *argv[]) {
	int status;
	int ret = syscall(SYS_arch_prctl, ARCH_SHSTK_STATUS, &status);
	printf("Status: %d %d\n", ret, status);

	vulnerable_function();

	return 0;
}

